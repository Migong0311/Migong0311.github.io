<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Smart Todo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* ì‚¬ìš©ì ì •ì˜ ìŠ¤íƒ€ì¼ */
    body {
      background-color: #f8f9fa; /* ë¶€ë“œëŸ¬ìš´ íšŒìƒ‰ ë°°ê²½ */
    }
    .todo-container {
      max-width: 600px;
      margin-top: 50px;
    }
    .completed-text {
      text-decoration: line-through;
      color: #adb5bd;
    }
    .cursor-pointer {
      cursor: pointer;
    }
    /* íŠ¸ëœì§€ì…˜ íš¨ê³¼ */
    .list-enter-active, .list-leave-active {
      transition: all 0.5s ease;
    }
    .list-enter-from, .list-leave-to {
      opacity: 0;
      transform: translateX(30px);
    }
  </style>
</head>

<body>
  <div id="app" class="container todo-container">
    
    <div class="card shadow-sm border-0">
      <div class="card-header bg-primary text-white p-4">
        <h2 class="fw-bold mb-0">ğŸ“… My Daily Todo</h2>
        <p class="mb-0 mt-2">ì˜¤ëŠ˜ í•  ì¼ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ì„¸ìš”.</p>
      </div>
      
      <div class="card-body p-4">
        <div class="mb-4">
          <div class="d-flex justify-content-between mb-1">
            <span class="fw-bold text-primary">ì§„í–‰ë¥ </span>
            <span class="text-secondary">{{ completedCount }} / {{ totalCount }} ì™„ë£Œ</span>
          </div>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar bg-success" role="progressbar" 
                 :style="{ width: progressPercent + '%' }" 
                 aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
        </div>

        <form @submit.prevent="addTodo" class="input-group mb-4 shadow-sm">
          <input type="text" class="form-control form-control-lg" 
                 v-model="userInput" 
                 placeholder="ìƒˆë¡œìš´ í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”..." 
                 autofocus>
          <button class="btn btn-primary px-4" type="submit">ì¶”ê°€</button>
        </form>

        <ul class="list-group list-group-flush">
          <li v-if="todos.length === 0" class="list-group-item text-center text-muted py-5">
            ë“±ë¡ëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤. ì˜¤ëŠ˜ í•˜ë£¨ë¥¼ ê³„íší•´ ë³´ì„¸ìš”!
          </li>

          <li v-for="todo in todos" :key="todo.id" 
              class="list-group-item d-flex justify-content-between align-items-center py-3">
            
            <div class="d-flex align-items-center">
              <input class="form-check-input me-3" type="checkbox" 
                     v-model="todo.isCompleted" 
                     style="width: 1.5em; height: 1.5em; cursor: pointer;">
              
              <span :class="{ 'completed-text': todo.isCompleted }" class="fs-5">
                {{ todo.text }}
              </span>
            </div>

            <button @click="deleteTodo(todo.id)" class="btn btn-outline-danger btn-sm rounded-pill px-3">
              ì‚­ì œ
            </button>
          </li>
        </ul>
      </div>
      
      <div class="card-footer bg-white text-end py-3">
         <button v-if="todos.length > 0" @click="clearAll" class="btn btn-link text-danger text-decoration-none btn-sm">
           ì „ì²´ ì‚­ì œ
         </button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script>
    const { createApp, ref, computed, watch, onMounted } = Vue

    const app = createApp({
      setup() {
        const userInput = ref("")
        const todos = ref([])

        // [ê¸°ëŠ¥ ì¶”ê°€ 1] LocalStorageì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (ì´ˆê¸°í™”)
        const loadTodos = () => {
          const savedTodos = localStorage.getItem('my_todos')
          if (savedTodos) {
            todos.value = JSON.parse(savedTodos)
          }
        }

        // ì•±ì´ ë§ˆìš´íŠ¸ë  ë•Œ ë°ì´í„° ë¡œë“œ
        onMounted(() => {
          loadTodos()
        })

        // [ê¸°ëŠ¥ ì¶”ê°€ 2] ë°ì´í„° ë³€ê²½ ê°ì§€ ë° ìë™ ì €ì¥ (Watch)
        // todos ë°°ì—´ ë‚´ë¶€ì˜ ë³€í™”ê¹Œì§€ ê°ì§€í•˜ê¸° ìœ„í•´ { deep: true } ì˜µì…˜ ì‚¬ìš©
        watch(todos, (newTodos) => {
          localStorage.setItem('my_todos', JSON.stringify(newTodos))
        }, { deep: true })


        // [ê¸°ëŠ¥ ì¶”ê°€ 3] ì§„í–‰ë¥  ê³„ì‚° (Computed)
        const totalCount = computed(() => todos.value.length)
        const completedCount = computed(() => todos.value.filter(t => t.isCompleted).length)
        const progressPercent = computed(() => {
          if (totalCount.value === 0) return 0
          return Math.round((completedCount.value / totalCount.value) * 100)
        })


        // í•  ì¼ ì¶”ê°€
        const addTodo = () => {
          if (userInput.value.trim() === "") {
            alert("ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!"); // ê°„ë‹¨í•œ ì•Œë¦¼ ì¶”ê°€
            return 
          }

          const newTodo = {
            id: Date.now(),
            text: userInput.value,
            isCompleted: false
          }

          todos.value.push(newTodo) // watchê°€ ê°ì§€í•˜ì—¬ ìë™ ì €ì¥ë¨
          userInput.value = ""
        }

        // í•  ì¼ ì‚­ì œ
        const deleteTodo = (id) => {
          if (!confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return
          
          const index = todos.value.findIndex((todo) => todo.id === id)
          if (index !== -1) {
            todos.value.splice(index, 1)
          }
        }

        // ì „ì²´ ì‚­ì œ ê¸°ëŠ¥
        const clearAll = () => {
          if(confirm("ëª¨ë“  ê¸°ë¡ì„ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            todos.value = []
          }
        }

        return {
          todos,
          userInput,
          addTodo,
          deleteTodo,
          clearAll,
          totalCount,
          completedCount,
          progressPercent
        }
      }
    })

    app.mount('#app')
  </script>
</body>

</html>