# 🧩 (실습-문제) 2-2 합성 데이터 실습 요약 정리

## 🎯 학습 목표

* **합성 데이터(Synthetic Data)** 개념과 생성 절차 이해
* **Prompt Engineering**을 활용한 데이터 생성
* **LLM as a Judge**를 통한 자동 품질 평가 구현
* API 통신(`httpx`), 환경 변수(`dotenv`), 구조적 출력(JSON) 학습

---

## 1️⃣ 환경 설정 및 기초 라이브러리

### 📦 주요 라이브러리

| 라이브러리    | 역할                                  |
| -------- | ----------------------------------- |
| `dotenv` | `.env` 파일을 통해 **API Key 보안 관리**     |
| `httpx`  | **비동기 HTTP 요청** 지원 (requests보다 효율적) |
| `json`   | 모델 응답을 **구조화된 딕셔너리(JSON)** 형태로 변환   |

### ⚙️ 환경 변수 관리

* API 키를 코드에 직접 쓰지 않고 `.env` 파일로 관리
* `load_dotenv()`로 환경 변수 불러오기
* 보안상 `.env`는 `.gitignore`에 추가하여 GitHub 유출 방지

### 🧠 비동기 통신(httpx)

* `async with httpx.AsyncClient()` 사용 시 **여러 API 호출 병렬 처리 가능**
* CPU 대기 시간 없이 빠른 응답 처리
* `asyncio.gather()`로 다중 프롬프트 병렬 호출 구현

### 💡 JSON 처리 개념

* 모델이 생성한 텍스트를 **`json.loads()`** 로 구조화 가능
* 파싱 오류 방지를 위해 `try/except`로 예외 처리 권장
* 안정성을 위해 `response_format` 또는 **명시적 JSON Schema** 사용 가능

---

## 2️⃣ 합성 데이터(Synthetic Data) 생성

### 📘 개념 요약

> **합성 데이터란?**
> 실제 수집 데이터가 아닌, **AI 모델을 이용해 인공적으로 생성된 데이터**
> (예: 영화 추천, 질병 데이터, 이미지 합성 등)

**활용 목적**

1. 데이터 부족 해결
2. 개인정보 보호
3. 비용 절감
4. 다양한 시나리오 실험 가능

---

### 🧠 Prompt Engineering 핵심

| 구성 요소       | 설명        | 예시                 |
| ----------- | --------- | ------------------ |
| Role        | 모델의 역할 지정 | “당신은 영화 전문가입니다.”   |
| Task        | 수행할 작업 명시 | “공포 영화를 하나 추천하세요.” |
| Constraints | 조건/형식 제시  | “JSON으로 응답하세요.”    |
| Examples    | 예시 제공     | 예시 출력 구조 추가        |

**좋은 프롬프트의 조건**

* 명확성 (Ambiguity 최소화)
* 맥락 제공 (Context 포함)
* 출력 형식 명시 (표, JSON 등)
* 일관된 스타일 유지

---

### 🧩 Generator System Prompt 설계

```text
당신은 세상의 모든 영화를 꿰뚫고 있는 영화 전문가 ‘시네마스터’입니다.  
사용자의 요청에 맞춰 영화를 추천합니다.  
반드시 하나의 영화만, 다음 형식(JSON)으로 응답합니다.
```

```json
{
  "title": "영화 제목",
  "year": "개봉 연도",
  "reason": "추천 이유"
}
```

**Temperature 조절**

* `0.0` → 일관성 높고 창의성 낮음
* `1.0` → 다양성/창의성 증가
  → 데이터 다양화 목적이면 **0.7~1.0** 정도가 적절

---

## 3️⃣ 합성 데이터 품질 평가 — LLM as a Judge

### ⚖️ 개념 요약

> “LLM이 생성된 데이터를 스스로 평가하는 방식”

| 항목 | 설명                               |
| -- | -------------------------------- |
| 목적 | 자동 품질 평가 (인간 대신 LLM이 평가자 역할)     |
| 장점 | 빠르고 일관된 평가 가능                    |
| 한계 | 동일 모델 사용 시 **긍정 편향(Bias)** 발생 가능 |
| 원칙 | 평가 모델은 생성 모델보다 크거나 다른 모델 사용 권장   |

---

### 📋 Judge System Prompt 구조

```text
당신의 역할은 모델 답변 자동 평가자입니다.
입력 프롬프트와 모델 답변을 보고, 기준(criteria)에 따라 평가하세요.

출력 형식(JSON):
{
  "score": 1~5,
  "comment": "평가 근거 (한국어 1~3문장)"
}
```

**채점 기준 예시**

* 사용자의 요구(예: “공포 영화”)에 맞는가
* 필수 항목(제목·연도·이유)을 모두 포함했는가
* 이유가 논리적이고 설득력 있는가

---

## 4️⃣ 전체 학습 흐름 요약

| 단계       | 구성                    | 핵심 내용               |
| -------- | --------------------- | ------------------- |
| ① 환경설정   | dotenv / httpx / json | API Key 관리 및 비동기 통신 |
| ② 데이터 생성 | Prompt Engineering    | 영화 추천 합성 데이터 생성     |
| ③ 품질 평가  | LLM as a Judge        | 생성 데이터의 품질 자동 점검    |
| ④ 결과 분석  | score + comment       | 평가 결과 기반 데이터 개선     |

---

## 🧾 핵심 정리

| 개념                     | 핵심 요약                      |
| ---------------------- | -------------------------- |
| **합성 데이터**             | 실제 데이터 없이 인공적으로 생성한 데이터    |
| **Prompt Engineering** | 모델 출력 품질을 제어하는 입력 설계 기술    |
| **LLM as a Judge**     | 생성된 데이터 품질을 자동으로 평가하는 LLM  |
| **Temperature**        | 응답의 창의성/일관성 제어 파라미터        |
| **JSON 구조화 출력**        | 모델 응답을 표준 형식으로 변환하여 후처리 용이 |

---

## 🔍 결론

* 합성 데이터는 **데이터 부족·보안 문제를 해결하는 대안**이며,
* Prompt Engineering과 LLM as a Judge의 결합을 통해
  **데이터 생성–평가–개선의 자동화 루프(Auto Loop)** 를 구성할 수 있다.

👉 핵심은 **“프롬프트 설계의 명확성”** 과 **“평가 기준의 일관성”** 이다.

